IF
    previous-exist AND (any-exist unvisited sibling)
THEN
    select-random sibling
ELSE
    select-random