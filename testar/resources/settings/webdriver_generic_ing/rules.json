{
  "oracle": [
    {
      "doc": [ "any SEVERE log message is a failure" ],
      "xquery": [ "ancestor::form[@name = 'bla']//tst:log/entry[@level = 'SEVERE' and contains(@msg, 'reference missing')]" ],
      "severity": [ "1.0" ]
    },
    {
      "doc": [ "any SEVERE log message is a failure" ],
      "xquery": [ "tst:log/entry[@level = 'WARNING' and contains(@msg, 'dfhdfiog')]" ],
      "severity": [ "0.3" ]
    }
  ],
  "ignore-filter": [
    {
      "doc": [ "" ],
      "xquery": [ "@disabled" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ ".[name() = 'label']" ]
    },
    {
      "doc": [ "select options, not the select widget itself" ],
      "xquery": [ ".[name() = 'select']" ]
    },
    {
      "doc": [ "ignore aria-hidden" ],
      "xquery": [ "ancestor-or-self::*[@aria-hidden = 'true']" ]
    },
    {
      "doc": [ "ignore links without href" ],
      "xquery": [ ".[(name() = 'a') and (not(@href))]" ]
    },
    {
      "doc": [ "ignore header" ],
      "xquery": [ "ancestor::header" ]
    },
    {
      "doc": [ "ignore next step" ],
      "xquery": [ "ancestor::ing-feat-sc-house-next-step-based-on-house-card" ]
    },
    {
      "doc": [ "ignore more info" ],
      "xquery": [ "ancestor-or-self::ing-button[contains(@id, 'moreInfoButton')]" ]
    },
    {
      "doc": [ "ignore stop button" ],
      "xquery": [ ".[@id = 'action-stop']" ]
    },
    {
      "doc": [ "ignore back button" ],
      "xquery": [ ".[@id = 'action-back']" ]
    },
    {
      "doc": [ "ignore body" ],
      "xquery": [ ".[name() = 'body']" ]
    },
    {
      "doc": [ "ignore progress section" ],
      "xquery": [ "ancestor::*[contains(@slot, 'progress')]" ]
    },
    {
      "doc": [ "ignore progress section" ],
      "xquery": [ "ancestor::*[contains(@class, 'progress')]" ]
    },
    {
      "doc": [ "ignore demo" ],
      "xquery": [ "ancestor::section[@class = 'demo-menu']" ]
    },
    {
      "doc": [ "ignore outside links" ],
      "xquery": [ ".[contains(@href, 'bel-me-nu')]" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ ".[ends-with(@href, 'hypotheek-berekenen/')]" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ ".[@target = '_blank']" ]
    },
    {
      "doc": [ "don't log in" ],
      "xquery": [ "ancestor::*[@data-tag-name = 'ing-feat-moir-intro'] and .[not(@id = 'startFlow')]" ]
    },
    {
      "doc": [ "ignore income wrapper" ],
      "xquery": [ ".[@name = 'incomeWrapper']" ]
    },
    {
      "doc": [ "ignore form" ],
      "xquery": [ ".[name() = 'form']" ]
    },
    {
      "doc": [ "don't consider changing details" ],
      "xquery": [ "ancestor::*[@slot = 'details']" ]
    },
    {
      "doc": [ "don't confirm appointment" ],
      "xquery": [ "ancestor-or-self::*[@name = 'ing-feat-moir-appointment-confirmation']" ]
    }
  ],
  "generic-input": [
    {
      "doc": [ "" ],
      "xquery": [ "'true'" ],
      "regexp": [ "([0-9]{5,10})|([0-9]{1,5})|([A-Za-z ]{5,20}|([A-Za-z0-9 ]{5,10})|([A-Za-z0-9 ]{10,20})" ],
      "priority": [ "1" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'firstName')" ],
      "regexp": [ "(Robbert)|(Mark)" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'lastName')" ],
      "regexp": [ "(van Dalen)|(Bommel)" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'surName')" ],
      "regexp": [ "(van Dalen)|(Bommel)" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'email')" ],
      "regexp": [ "([a-z0-9._%+-]{4,15}@[a-z0-9.-]{5,10}\\.[a-z]{2,4})|(bla@company\\.com)|(sut@bla\\.nl)" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'enterpriseNumber')" ],
      "regexp": [ "(0415580365)|(0[0-9]{9})" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'age')" ],
      "regexp": [ "[1-8][0-9]" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'income')" ],
      "regexp": [ "[1-9][0-9]{4}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'profit')" ],
      "regexp": [ "[1-9][0-9]{4}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:formInputRule(., 'income', 'years[]')" ],
      "regexp": [ "[1-9][0-9]{4}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'monthlyIncome')" ],
      "regexp": [ "[1-7][0-9]{3}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'studyLoan')" ],
      "regexp": [ "[1-3][0-9]{4}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'liabilities')" ],
      "regexp": [ "[1-3][0-9]{4}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'alimony')" ],
      "regexp": [ "[0-9]{3}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'annualTurnover')" ],
      "regexp": [ "[1-9][0-9]{4,6}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'endBalance')" ],
      "regexp": [ "[1-9][0-9]{4,6}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'availableCash')" ],
      "regexp": [ "[1-9][0-9]{4,6}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'shareholderSupport')" ],
      "regexp": [ "[1-9][0-9]{4,6}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'newLoan')" ],
      "regexp": [ "[1-9][0-9]{4,6}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'needAmount')" ],
      "regexp": [ "[1-9][0-9]{4,6}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'needDuration')" ],
      "regexp": [ "[1-3]|[0-9]" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'numberEmployees')" ],
      "regexp": [ "[1-9]{2,4}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "ancestor::ing-flow-form[contains(@name, 'expectedRevenue')]" ],
      "regexp": [ "[1-9][0-9]{4}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "ancestor::ing-flow-form[contains(@name, 'expectedCosts')]" ],
      "regexp": [ "[1-9][0-9]{4}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "ancestor::ing-flow-form[contains(@name, 'otherPaymentPostponement')]" ],
      "regexp": [ "[1-9][0-9]{4}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "ancestor::ing-flow-form[contains(@name, 'ingLoanRepayment')]" ],
      "regexp": [ "[1-9][0-9]{4,5}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "ancestor::*[contains(lower-case(@label), 'yearly amount')]" ],
      "regexp": [ "[1-7][0-9]{4}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "ancestor::*[contains(lower-case(@label), 'monthly amount')]" ],
      "regexp": [ "[1-4][0-9]{3}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'monthlyReimbursementInput')" ],
      "regexp": [ "[1-2][0-9]{2,3}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "ancestor::*[contains(lower-case(@label), 'monthly repayment')]" ],
      "regexp": [ "[1-9][0-9]{3}" ],
      "priority": [ "1" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'dependantsValue')" ],
      "regexp": [ "[1-6]" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'ownFundsInput')" ],
      "regexp": [ "[1-9][0-9]{4}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'postalCode')" ],
      "regexp": [ "[1-9]{4}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'street')" ],
      "regexp": [ "Fantasy Street" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'box')" ],
      "regexp": [ "[1-9]" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'number')" ],
      "regexp": [ "[1-9][1-9]{1,2}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'ingId')" ],
      "regexp": [ "(0000000097)|(0144658019)" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'phone')" ],
      "regexp": [ "0648949801" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'transferabilityRegistrationFeesAmount')" ],
      "regexp": [ "[1-9]{3}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'birthdate')" ],
      "regexp": [ "[0-2][1-9]\/[1-9]\/19[1-9]{2}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'buildingPrice')" ],
      "regexp": [ "[1-9][0-9]{4,5}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'homePrice')" ],
      "regexp": [ "[1-2][0-9]{5}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ "h:inputRule(., 'constructionLotPrice')" ],
      "regexp": [ "[1-9][0-9]{4,5}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ ".[contains(lower-case(@name), 'firstname')]/ancestor::*[contains(lower-case(@name), 'personal-details')]" ],
      "regexp": [ "[a-zA-Z ]{5,15}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ ".[contains(lower-case(@name), 'name')]/ancestor::*[contains(lower-case(@name), 'personal-details')]" ],
      "regexp": [ "[a-zA-Z ]{5,15}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ ".[contains(lower-case(@name), 'dataofbirth')]/ancestor::*[contains(lower-case(@name), 'personal-details')]" ],
      "regexp": [ "(01|13|22|31)/(02|07|10|12)/(1977|1984|1991|2000|2014|2021)" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ ".[contains(lower-case(@name), 'number')]/ancestor::*[contains(lower-case(@name), 'personal-details')]" ],
      "regexp": [ "[0-9a-zA-Z ]{5,15}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ ".[contains(lower-case(@name), 'boxnumber')]/ancestor::*[contains(lower-case(@name), 'personal-details')]" ],
      "regexp": [ "[0-9a-zA-Z ]{5,15}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ ".[contains(lower-case(@name), 'postalcode')]/ancestor::*[contains(lower-case(@name), 'personal-details')]" ],
      "regexp": [ "[0-9]{5,15}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ ".[contains(lower-case(@name), 'city')]/ancestor::*[contains(lower-case(@name), 'personal-details')]" ],
      "regexp": [ "[a-zA-Z ]{5,15}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ ".[contains(lower-case(@name), 'email')]/ancestor::*[contains(lower-case(@name), 'personal-details')]" ],
      "regexp": [ "([a-z0-9._%+-]{4,15}@[a-z0-9.-]{5,10}\\.[a-z]{2,4})|(bla@company\\.com)|(sut@bla\\.nl)" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ ".[contains(lower-case(@name), 'mobile')]/ancestor::*[contains(lower-case(@name), 'personal-details')]" ],
      "regexp": [ "[+]?[0-9]{10}" ],
      "priority": [ "5" ]
    },
    {
      "doc": [ "" ],
      "xquery": [ ".[contains(lower-case(@name), 'iban-nl')]/ancestor::*[contains(lower-case(@name), 'corporate-details')]" ],
      "regexp": [ "(NL20 INGB 0001 2345 67)|([A-Z0-9]{4} [0-9]{4} [0-9]{3}([A-Z0-9] [A-Z0-9]{0,4} [A-Z0-9]{0,4} [A-Z0-9]{0,4} [A-Z0-9]{0,3}))" ],
      "priority": [ "5" ]
    }
  ],
  "action-priority": [
    {
      "doc": [ "default priority" ],
      "xquery": [ "'true'" ],
      "priority": [ "1" ]
    },
    {
      "doc": [ "action visited and not submit or invalid" ],
      "xquery": [ ".[not(@type = 'submit')] and not(ancestor-or-self::*[h:is-invalid(.)]) and tst:visits[@count > 0]" ],
      "priority": [ "1 div (1 + count(tst:visits))" ]
    },
    {
      "doc": [ "submit button has higher priority when there are still non-defined inputs" ],
      "xquery": [ ".[@type = 'submit']" ],
      "priority": [
        "1 + count(ancestor::form//*[(h:radiogroup-is-empty(.) or ",
        "h:text-is-empty(.) or ",
        "h:select-is-empty(.)) and h:is-valid(.)])"
      ]
    },
    {
      "doc": [ "boost invalid inputs" ],
      "xquery": [ "h:is-invalid(.)" ],
      "priority": [ "3.0" ]
    },
    {
      "doc": [ "boost invalid inputs" ],
      "xquery": [ "h:is-radio(.) and ancestor::*[h:is-radiogroup(.) and h:is-invalid(.)]" ],
      "priority": [ "3.0" ]
    },
    {
      "doc": [ "weighted exclusive radio button" ],
      "xquery": [ "h:is-radio(.)" ],
      "priority": [ "1.0 div (max ((1.0, count(h:sibling-radios(.)))))" ]
    },
    {
      "doc": [ "weighted exclusive option button" ],
      "xquery": [ "h:is-option(.)" ],
      "priority": [ "1.0 div (max((1.0, count(h:sibling-options(.)))))" ]
    },
    {
      "doc": [ "radio button in same group already selected" ],
      "xquery": [
        "h:is-radio(.) and ",
        "ancestor::*[h:is-radiogroup(.) and ",
        "not(h:radiogroup-is-empty(.)) and ",
        "h:is-valid(.)]"
      ],
      "priority": [ "0.3" ]
    },
    {
      "doc": [ "text input already provided" ],
      "xquery": [ "h:is-text(.) and not(h:text-is-empty(.)) and h:is-valid(.)" ],
      "priority": [ "0.3" ]
    },
    {
      "doc": [ "select button in same selection already selected" ],
      "xquery": [ "h:is-select(.) and not(h:select-is-empty(.)) and h:is-valid(.)" ],
      "priority": [ "0.3" ]
    },
    {
      "doc": [ "De-prioritize close button" ],
      "xquery": [ "ancestor-or-self::*[@aria-label = 'Close']" ],
      "priority": [ "0.3" ]
    }
  ]
}